(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{8041:function(e,t,r){Promise.resolve().then(r.bind(r,5662))},5662:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(7437),a=r(2265),n=r(9376),i=r(1072),o=r(2381),l=r(279),u=r(5060),d=r(9820),c=r(4438);let f=(0,r(9205).Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var m=r(2208);let h=async()=>{try{let{data:{user:e}}=await i.O.auth.getUser();if(!e)return!1;let{data:t,error:r}=await i.O.from("user_roles").select("id").eq("role","admin").limit(1);if(r)throw r;if(!t||0===t.length){let{error:t}=await i.O.from("user_roles").insert({user_id:e.id,role:"admin"});if(t)throw t;return console.log("First admin assigned successfully"),!0}return!1}catch(e){return console.error("Error auto-assigning admin:",e),!1}},g=r(7119).Z_().min(8,{message:"كلمة المرور يجب أن تتكون من 8 أحرف على الأقل"}).regex(/[A-Z]/,{message:"كلمة المرور يجب أن تحتوي على حرف كبير واحد على الأقل"}).regex(/[a-z]/,{message:"كلمة المرور يجب أن تحتوي على حرف صغير واحد على الأقل"}).regex(/[0-9]/,{message:"كلمة المرور يجب أن تحتوي على رقم واحد على الأقل"});function p(){let[e,t]=(0,a.useState)(!0),[r,p]=(0,a.useState)(""),[x,b]=(0,a.useState)(""),[y,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),[j,k]=(0,a.useState)(""),I=(0,n.useRouter)();(0,a.useEffect)(()=>{i.O.auth.getSession().then(e=>{let{data:{session:t}}=e;t&&O()});let{data:{subscription:e}}=i.O.auth.onAuthStateChange((e,t)=>{if(t&&"SIGNED_IN"===e)return});return()=>e.unsubscribe()},[I]);let O=async()=>{let{data:{session:e}}=await i.O.auth.getSession();if(!e)return;let{data:t}=await i.O.from("user_roles").select("role").eq("user_id",e.user.id).eq("role","admin").maybeSingle();t&&I.push("/dashboard")},_=async t=>{if(t.preventDefault(),k(""),!e){let e=g.safeParse(x);if(!e.success){k(e.error.errors[0].message);return}}N(!0);try{if(e){let{error:e}=await i.O.auth.signInWithPassword({email:r,password:x});if(e)throw e;await h()&&await new Promise(e=>setTimeout(e,500)),c.Am.success("تم تسجيل الدخول بنجاح"),I.push("/dashboard")}else{let{error:e}=await i.O.auth.signUp({email:r,password:x,options:{emailRedirectTo:"".concat(window.location.origin,"/dashboard")}});if(e)throw e;await h()&&await new Promise(e=>setTimeout(e,500)),c.Am.success("تم إنشاء الحساب بنجاح"),I.push("/dashboard")}}catch(e){c.Am.error(e.message||"حدث خطأ ما")}finally{N(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,s.jsxs)(d.Zb,{className:"w-full max-w-md",children:[(0,s.jsxs)(d.Ol,{className:"space-y-1",children:[(0,s.jsx)(d.ll,{className:"text-2xl text-center",children:e?"تسجيل الدخول":"إنشاء حساب جديد"}),(0,s.jsx)(d.SZ,{className:"text-center",children:e?"أدخل بياناتك للوصول إلى لوحة التحكم":"أدخل بياناتك لإنشاء حساب جديد"})]}),(0,s.jsxs)(d.aY,{children:[(0,s.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"email",children:"البريد الإلكتروني"}),(0,s.jsx)(l.I,{id:"email",type:"email",placeholder:"example@email.com",value:r,onChange:e=>p(e.target.value),required:!0,dir:"ltr"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"password",children:"كلمة المرور"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.I,{id:"password",type:y?"text":"password",placeholder:"••••••••",value:x,onChange:e=>b(e.target.value),required:!0,dir:"ltr"}),(0,s.jsx)("button",{type:"button",onClick:()=>v(!y),className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:y?(0,s.jsx)(f,{size:18}):(0,s.jsx)(m.Z,{size:18})})]}),j&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:j}),!e&&!j&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"يجب أن تحتوي على 8 أحرف، حرف كبير، حرف صغير، ورقم"})]}),(0,s.jsx)(o.z,{type:"submit",className:"w-full",disabled:w,children:w?"جاري التحميل...":e?"تسجيل الدخول":"إنشاء حساب"})]}),(0,s.jsx)("div",{className:"mt-4 text-center text-sm",children:(0,s.jsx)("button",{type:"button",onClick:()=>t(!e),className:"text-primary hover:underline",children:e?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب؟ تسجيل الدخول"})})]})]})})}},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},2381:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return u}});var s=r(7437),a=r(2265),n=r(7495),i=r(535),o=r(3448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-gradient-primary text-primary-foreground hover:shadow-glow transform hover:scale-105 transition-all duration-300 border-0 shadow-elegant"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:u=!1,...d}=e,c=u?n.g7:"button";return(0,s.jsx)(c,{className:(0,o.cn)(l({variant:a,size:i,className:r})),ref:t,...d})});u.displayName="Button"},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return u},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var s=r(7437),a=r(2265),n=r(3448);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});u.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},279:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var s=r(7437),a=r(2265),n=r(3448);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},5060:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var s=r(7437),a=r(2265),n=r(6394),i=r(535),o=r(3448);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.f,{ref:t,className:(0,o.cn)(l(),r),...a})});u.displayName=n.f.displayName},1072:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});let s=(0,r(3887).eI)("https://xhsdrasgednxnuqchgub.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhoc2RyYXNnZWRueG51cWNoZ3ViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNjk1OTgsImV4cCI6MjA3NDc0NTU5OH0.X_VFeV6CkuFOojDI6HJv80aPe0UvZtLduESaxLhyrcA",{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}})},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var s=r(1994),a=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}}},function(e){e.O(0,[203,887,27,33,971,117,744],function(){return e(e.s=8041)}),_N_E=e.O()}]);